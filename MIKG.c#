Imports System
Imports System.Text
Imports Hyland.Unity
Imports Hyland.Unity.Workflow

'Skeleton generated by Hyland Unity Editor on 8/17/2016 3:57:59 PM
Namespace TestUnityProject
    
    '''<summary>
    '''Test Unity Project
    '''</summary>
    Public Class TestUnityProject
        Implements Hyland.Unity.IWorkflowScript
        
        #Region "IWorkflowScript"
        '''<summary>
        '''Implementation of <see cref="IWorkflowScript.OnWorkflowScriptExecute" />.
        '''<seealso cref="IWorkflowScript" />
        '''</summary>
        '''<param name="app"></param>
        '''<param name="args"></param>
        Public Sub OnWorkflowScriptExecute(ByVal app As Hyland.Unity.Application, ByVal args As Hyland.Unity.WorkflowEventArgs) Implements IWorkflowScript.OnWorkflowScriptExecute
   Dim doc_type As Document = app.Core.GetDocumentByID(args.Document.ID)
   Dim kw_test = ""
   Dim recType
   Dim kw_type
   Dim kw_store
   For Each recType In doc_type.KeywordRecords
    For Each kw_type In recType.Keywords
     If recType.ID > "1" Then
      If kw_type.IsBlank Then
       kw_store = "BLANK"
      Else
       kw_store = kw_type.Value
      End If
      If kw_test = "" Then
       kw_test = kw_store
      Else
       kw_test = kw_test & "~" & kw_store
      End If
     End If
    Next
    kw_test = kw_test & "|"
   Next
   
   args.SessionPropertyBag.Set( "Test2", kw_test )
        End Sub
        #End Region
    End Class
End Namespace
